"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[782],{782:(e,t,n)=>{n.r(t),n.d(t,{addIcon:()=>O,renderPipeline:()=>_,resetPipelineFocus:()=>w}),n(139);function r(){this._nodes={},this._edges=[]}function i(){this.spaces=[]}function o(e){this.index=e,this.nodes=[],this.ordering=new i}function s(e){this.id=e.id,this.name=e.name,this.icon=e.icon,this.class=e.class,this.status=e.status,this.repeatable=e.repeatable,this.key=e.key,this.url=e.url,this.svg=e.svg,this.equivalentBy=e.equivalentBy,this.label=void 0,this._edgeTargets={},this._edgeSources={},this._edgeKeys=[],this._inEdges=[],this._outEdges=[],this._cachedRank=-1,this._cachedWidth=0,this._keyOffset=0,this._position={x:0,y:0}}r.prototype.setNode=function(e,t){this._nodes[e]=t},r.prototype.removeNode=function(e){var t=this._nodes[e];for(var n in t._inEdges){var r=(s=t._inEdges[n]).source.node,i=r._outEdges.indexOf(s);r._outEdges.splice(i,1);var o=this._edges.indexOf(s);this._edges.splice(o,1)}for(var n in t._outEdges){var s,a=(s=t._outEdges[n]).target.node;i=a._inEdges.indexOf(s),a._inEdges.splice(i,1),o=this._edges.indexOf(s),this._edges.splice(o,1)}delete this._nodes[e]},r.prototype.addEdge=function(e,t,n,r){var i=this._nodes[e];if(void 0===i)throw"source node does not exist: "+e;var o=this._nodes[t];if(void 0===o)throw"target node does not exist: "+t;for(var s in o._inEdges)if(o._inEdges[s].source.node.id==i.id)return;-1==i._edgeKeys.indexOf(n)&&i._edgeKeys.push(n),-1==o._edgeKeys.indexOf(n)&&o._edgeKeys.push(n);var a=i._edgeSources[n];a||(a=new c(i,n),i._edgeSources[n]=a);var d=o._edgeTargets[n];d||(d=new h(o,n),o._edgeTargets[n]=d);var f=new u(a,d,n,r);o._inEdges.push(f),i._outEdges.push(f),this._edges.push(f)},r.prototype.removeEdge=function(e){var t=e.target.node._inEdges.indexOf(e);e.target.node._inEdges.splice(t,1);var n=e.source.node._outEdges.indexOf(e);e.source.node._outEdges.splice(n,1);var r=this._edges.indexOf(e);this._edges.splice(r,1)},r.prototype.node=function(e){return this._nodes[e]},r.prototype.nodes=function(){var e=[];for(var t in this._nodes)e.push(this._nodes[t]);return e},r.prototype.edges=function(){return this._edges},r.prototype.layout=function(){var e=[];for(var t in this._nodes){var n=(r=this._nodes[t]).rank();(i=e[n])||(i=new o(n),e[n]=i),i.nodes.push(r)}for(var t in this._nodes){var r,i=(r=this._nodes[t]).rank(),s=0;for(var a in e)a<i&&(s+=e[a].width()+50);r._position.x=s+(e[i].width()-r.width())/2,r._edgeKeys.sort((function(e,t){var n=r._edgeTargets[e],i=r._edgeTargets[t];if(n&&!i)return-1;if(!n&&i)return 1;if(n&&i){var o=n.rankOfFirstAppearance(),s=i.rankOfFirstAppearance();if(o<s)return-1;if(o>s)return 1}var a=r._edgeSources[e],d=r._edgeSources[t];return a&&!d?-1:!a&&d?1:f(e,t)}))}for(var d=0;d<2;d++)for(var a in e)e[a].sortNodes(),e[a].layout();if("#untug"!=window.location.hash)for(var u=!0;u;)for(var a in u=!1,e)e[a].tug()&&(u=!0)},r.prototype.computeRanks=function(){var e={};for(var t in this._nodes)0==(i=this._nodes[t])._inEdges.length&&(i._cachedRank=0,e[i.id]=i);for(var n={};!l(e);){var r={};for(var t in e){var i=e[t];for(var o in 0==i._outEdges.length&&(n[i.id]=i),i._outEdges){var s=i._outEdges[o].target.node;if(s._cachedRank=Math.max(s._cachedRank,i._cachedRank+1),s._cachedRank>1e4)throw new Error("Likely infinite loop involving: ["+i.id+"] and ["+s.id+"]");r[s.id]=s}}e=r}for(var a=n;!l(a);){var d={};for(var t in a)for(var o in(i=a[t])._inEdges){var u=i._inEdges[o].source.node,c=u.latestPossibleRank();void 0!==c&&(u._cachedRank=c),d[u.id]=u}a=d}},r.prototype.collapseEquivalentNodes=function(){var e=[];for(var t in this._nodes){var n=this._nodes[t],r=e[n.rank()];void 0===r&&(r={},e[n.rank()]=r),void 0!==n.equivalentBy&&(void 0===(o=r[n.equivalentBy])&&(o=[],r[n.equivalentBy]=o),o.push(n))}for(var i in e){var o=e[i];for(var s in o){var a=o[s];if(1!=a.length)for(var d=a[0],u=1;u<a.length;u++){var c=a[u];for(var h in c._inEdges){var f=c._inEdges[h];this.addEdge(f.source.node.id,d.id,f.key,f.customData)}for(var l in c._outEdges)f=c._outEdges[l],this.addEdge(d.id,f.target.node.id,f.key,f.customData);this.removeNode(c.id)}}}},r.prototype.addSpacingNodes=function(){var e=[];for(var t in this._edges){var n=this._edges[t],r=n.target.node.rank()-n.source.node.rank();if(r>1){var i,o,s,a=n.source.node,d=n.target.node;n.source.node.repeatable?(i=a,o=null,s=n.customData):(i=d,o=n.customData,s=null);for(var u=0;u<r-1;u++){var c=n.id()+"-spacing-"+u,h=this.node(c);h||((h=i.copy()).id=c,h._cachedRank=a.rank()+1,this.setNode(h.id,h));var f=0==u?o:null;this.addEdge(a.id,h.id,n.key,f),a=h}this.addEdge(a.id,n.target.node.id,n.key,s),e.push(n)}}for(var t in e)this.removeEdge(e[t])},i.prototype.fill=function(e,t){for(var n=e;n<e+t;n++)this.spaces[n]=!0},i.prototype.free=function(e,t){for(var n=e;n<e+t;n++)this.spaces[n]=!1},i.prototype.isFree=function(e,t){for(var n=e;n<e+t;n++)if(this.spaces[n])return!1;return!0},o.prototype.sortNodes=function(){var e=this.nodes,t=this.nodes.slice();e.sort((function(e,t){var n;if(e._inEdges.length&&t._inEdges.length&&0!=(n=e.highestUpstreamSource()-t.highestUpstreamSource()))return n;if(e._outEdges.length&&t._outEdges.length&&0!=(n=e.highestDownstreamTarget()-t.highestDownstreamTarget()))return n;if(e._inEdges.length&&t._outEdges.length&&0!=(n=e.highestUpstreamSource()-t.highestDownstreamTarget()))return n;if(e._outEdges.length&&t._inEdges.length&&0!=(n=e.highestDownstreamTarget()-t.highestUpstreamSource()))return n;var r=e.passedThroughAnyPreviousNode(),i=t.passedThroughAnyPreviousNode();if(r&&!i)return-1;var o=e.passesThroughAnyNextNode(),s=t.passesThroughAnyNextNode();if(o&&!s)return-1;var a=t._outEdges.length-e._outEdges.length;return 0!=a?a:!o&&s?1:(e.debugMarked=!0,t.debugMarked=!0,f(e.name,t.name))}));var n=!1;for(var r in e)e[r]!==t[r]&&(n=!0);return n},o.prototype.mark=function(){for(var e in this.nodes)this.nodes[e].rankGroupMarked=!0},o.prototype.width=function(){var e=0;for(var t in this.nodes)e=Math.max(e,this.nodes[t].width());return e},o.prototype.layout=function(){var e=0;for(var t in this.ordering=new i,this.nodes){var n=this.nodes[t];n._keyOffset=e,this.ordering.fill(e,Math.max(n._edgeKeys.length,1)),e+=Math.max(n._edgeKeys.length,1)}},o.prototype.tug=function(){for(var e=!1,t=this.nodes.length-1;t>=0;t--){var n=this.nodes[t],r=n.inAlignment();(void 0!==r&&n._keyOffset<r&&this.ordering.isFree(r,n._edgeKeys.length)||void 0!==(r=n.outAlignment())&&n._keyOffset<r&&this.ordering.isFree(r,n._edgeKeys.length))&&(this.ordering.free(n._keyOffset,n._edgeKeys.length),n._keyOffset=r,this.ordering.fill(n._keyOffset,n._edgeKeys.length),e=!0)}return this.nodes.sort((function(e,t){return e._keyOffset-t._keyOffset})),e},s.prototype.copy=function(){return new s({id:this.id,name:this.name,class:this.class,status:this.status,repeatable:this.repeatable,key:this.key,url:this.url,svg:this.svg,equivalentBy:this.equivalentBy})};var a,d=(a=document.createElement("canvas").getContext("2d"),function(e,t){return a.font=t,1.1*a.measureText(e).width});function u(e,t,n,r){this.source=e,this.target=t,this.key=n,this.customData=r}function c(e,t){this.node=e,this.key=t}function h(e,t){this.node=e,this.key=t}function f(e,t){var n=e.length-t.length;return 0!=n?n:e.localeCompare(t)}function l(e){for(var t in e)return!1;return!0}function p(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}s.prototype.width=function(){if(0==this._cachedWidth){var e=this.id,t=this.svg.selectAll("g.node").filter((function(t){return t.id==e})),n=t.select("text").node(),r=t.select("image").node(),i=t.select("use").node(),o=0;if(n&&(o+=d(n.innerHTML,"700 12px Inconsolata,monospace")),r&&(o+=8),i&&(o+=12),n&&r&&i&&(o+=10),(n&&r&&!i||n&&!r&&i||!n&&r&&i)&&(o+=5),0==o)return 0;this._cachedWidth=o}return this._cachedWidth+10},s.prototype.padding=function(){return 5},s.prototype.pinned=function(){return this.class.includes("pinned")},s.prototype.has_icon=function(){return void 0!==this.icon},s.prototype.height=function(){var e=Math.max(this._edgeKeys.length,1);return 20*e+10*(e-1)},s.prototype.position=function(){return{x:this._position.x,y:30*this._keyOffset}},s.prototype.animationRadius=function(){return this.class.search("job")>-1?70:0},s.prototype.rank=function(){return this._cachedRank},s.prototype.latestPossibleRank=function(){var e;for(var t in this._outEdges){var n=this._outEdges[t].target.node.rank()-1;e=void 0===e?n:Math.min(e,n)}return e},s.prototype.dependsOn=function(e,t){for(var n in this._inEdges){var r=this._inEdges[n].source.node;if(r==e)return!0;if(-1==t.indexOf(this)&&(t.push(this),r.dependsOn(e,t)))return!0}return!1},s.prototype.highestUpstreamSource=function(){var e,t;for(var n in this._inEdges)t=this._inEdges[n].source.effectiveKeyOffset(),(void 0===e||t<e)&&(e=t);return e},s.prototype.highestDownstreamTarget=function(){var e,t;for(var n in this._outEdges)t=this._outEdges[n].target.effectiveKeyOffset(),(void 0===e||t<e)&&(e=t);return e},s.prototype.inAlignment=function(){var e;for(var t in this._inEdges){var n=this._inEdges[t],r=n.source.effectiveKeyOffset();(void 0===e||r<e)&&(e=r-this._edgeKeys.indexOf(n.key))}return e},s.prototype.outAlignment=function(){var e;for(var t in this._outEdges){var n=this._outEdges[t],r=n.target.effectiveKeyOffset();(void 0===e||r<e)&&(e=r-this._edgeKeys.indexOf(n.key))}return e},s.prototype.passedThroughAnyPreviousNode=function(){for(var e in this._inEdges){var t=this._inEdges[e];if(t.key in t.source.node._edgeTargets)return!0}return!1},s.prototype.passesThroughAnyNextNode=function(){for(var e in this._outEdges){var t=this._outEdges[e];if(t.key in t.target.node._edgeSources)return!0}return!1},u.prototype.id=function(){return this.source.id()+"-to-"+this.target.id()},u.prototype.bezierPoints=function(){var e,t,n=this.source.position(),r=this.target.position();if(n.x>r.x){var i=this.source.node.position().y+this.source.node.height(),o=this.target.node.position().y+this.target.node.height();e={x:n.x+100,y:i+100},t={x:r.x-100,y:o+100}}else{var s=d3.interpolateNumber(n.x,r.x);e={x:s(.5),y:n.y},t={x:s(.5),y:r.y}}return[n,e,t,r]},u.prototype.path=function(){var e=this.bezierPoints();return"M"+e[0].x+","+e[0].y+" C"+e[1].x+","+e[1].y+" "+e[2].x+","+e[2].y+" "+e[3].x+","+e[3].y},c.prototype.width=function(){return 0},c.prototype.height=function(){return 0},c.prototype.effectiveKeyOffset=function(){return this.node._keyOffset+this.node._edgeKeys.indexOf(this.key)},c.prototype.id=function(){return this.node.id+"-"+this.key+"-source"},c.prototype.position=function(){return{x:this.node.position().x+this.node.width(),y:10+30*this.effectiveKeyOffset()}},h.prototype.width=function(){return 0},h.prototype.height=function(){return 0},h.prototype.effectiveKeyOffset=function(){return this.node._keyOffset+this.node._edgeKeys.indexOf(this.key)},h.prototype.rankOfFirstAppearance=function(){if(void 0!==this._rankOfFirstAppearance)return this._rankOfFirstAppearance;var e=this.node._inEdges,t=1/0;for(var n in e){var r=e[n];if(r.source.key==this.key){var i=r.source.node._inEdges;if(0==i.length){t=r.source.node.rank();break}var o=!1;for(var s in i){var a=i[s];if(a.target.key==this.key){o=!0;var d=a.target.rankOfFirstAppearance();d<t&&(t=d)}}if(!o){t=r.source.node.rank();break}}}return this._rankOfFirstAppearance=t,t},h.prototype.id=function(){return this.node.id+"-"+this.key+"-target"},h.prototype.position=function(){return{x:this.node.position().x,y:10+30*this.effectiveKeyOffset()}};var y,m=n.e(577).then(n.bind(n,577));function _(e,t,n){var i=function(e){var t=d3.select("g.test");return t.empty()&&(e.append("defs").append("filter").attr("id","embiggen").append("feMorphology").attr("operator","dilate").attr("radius","4"),t=e.append("g").attr("class","test"),e.on("mousedown",(function(){var e=d3.event;(e.button||e.ctrlKey)&&e.stopImmediatePropagation()})).call(E().scaleExtent([.5,10]).on("zoom",(function(){var e=d3.event;b?(b=!1,w()):t.attr("transform","translate("+e.translate+") scale("+e.scale+")")})))),t}(d3.select(".pipeline-graph"));null!=i.node()&&function(e,t,n,i){!function(e,t,n,i){return function(){d3.select(e.node().parentNode).attr("viewBox","0 0 0 0");var o=function(e,t,n){var i,o=new r,a={},d={},u={},c={},h=""===(i=window.location.search.substring(1).split("&").filter((function(e){return e.startsWith("vars.")||e.startsWith("vars=")})).join("&"))?"":"?"+i;for(var f in n){var l=n[f];a[l.name]="/teams/"+l.team_name+"/pipelines/"+l.pipeline_name+"/resources/"+encodeURIComponent(l.name)+h,d[l.name]=l.build,u[l.name]=l.pinned_version,c[l.name]=l.icon}for(var f in t){var p=A((T=t[f]).name),g=["job"],v="/teams/"+T.team_name+"/pipelines/"+T.pipeline_name+"/jobs/"+encodeURIComponent(T.name);if(T.next_build)v="/teams/"+(y=T.next_build).team_name+"/pipelines/"+y.pipeline_name+"/jobs/"+encodeURIComponent(y.job_name)+"/builds/"+y.name;else if(T.finished_build){var y;v="/teams/"+(y=T.finished_build).team_name+"/pipelines/"+y.pipeline_name+"/jobs/"+encodeURIComponent(y.job_name)+"/builds/"+y.name}v+=h,q=T.paused?"paused":T.finished_build?T.finished_build.status:"no-builds",g.push(q),T.next_build&&g.push(T.next_build.status),o.setNode(p,new s({id:p,name:T.name,class:g.join(" "),status:q,url:v,svg:e}))}var m=function(e){var t="";return d[e]&&(t+=" "+d[e].status),u[e]&&(t+=" pinned"),t};for(var f in t)for(var _ in p=A((T=t[f]).name),T.outputs){var k=T.outputs[_],x=K(T.name,k.resource),E=o.node(x);E||(O(c[k.resource],x),E=new s({id:x,name:k.resource,icon:c[k.resource],key:k.resource,class:"resource output"+m(k.resource),repeatable:!0,url:a[k.resource],svg:e}),o.setNode(x,E)),o.addEdge(p,x,k.resource,null)}for(var f in t)for(var _ in p=A((T=t[f]).name),T.inputs)if((M=T.inputs[_]).passed&&M.passed.length>0)for(var b in M.passed){var w,S=A(M.passed[b]),j=K(M.passed[b],M.resource),R=N(M.passed[b],M.resource);o.node(j)?w=j:(o.node(R)||(O(c[M.resource],R),o.setNode(R,new s({id:R,name:M.resource,icon:c[M.resource],key:M.resource,class:"resource constrained-input"+m(M.resource),repeatable:!0,url:a[M.resource],svg:e}))),o.node(S)&&o.addEdge(S,R,M.resource,null),w=R),o.addEdge(w,p,M.resource,{trigger:M.trigger})}for(var f in t){var T;for(var _ in p=A((T=t[f]).name),o.node(p),T.inputs){var M,q="";if(!(M=T.inputs[_]).passed||0==M.passed.length){var C=N(T.name,M.resource+"-unconstrained");o.node(C)||(O(c[M.resource],C),o.setNode(C,new s({id:C,name:M.resource,icon:c[M.resource],key:M.resource,class:"resource input"+m(M.resource),status:q,repeatable:!0,url:a[M.resource],svg:e,equivalentBy:M.resource+"-unconstrained"}))),o.addEdge(C,p,M.resource,{trigger:M.trigger})}}}return o.computeRanks(),o.collapseEquivalentNodes(),o.addSpacingNodes(),o}(e,t,n);e.selectAll("g.edge").remove(),e.selectAll("g.node").remove();var a=e.selectAll("g.edge").data(o.edges());a.exit().remove();var d=e.selectAll("g.node").data(o.nodes());d.exit().remove();var u=a.enter().append("g").attr("class",(function(e){return"edge "+e.source.node.status}));function c(e){e.key&&(y=e.key,a.each((function(t){t.source.key==e.key&&d3.select(this).classed({active:!0})})),d.each((function(t){t.key==e.key&&d3.select(this).classed({active:!0})})))}function h(e){e.key&&(y=void 0,a.classed({active:!1}),d.classed({active:!1}))}a.each((function(e){null!==e.customData&&!0!==e.customData.trigger&&d3.select(this).classed("trigger-false",!0)}));var f=d.enter().append("g").attr("id",(function(e){return"node-"+e.id})).attr("class",(function(e){return"node "+e.class})).on("mouseover",c).on("mouseout",h),l=f.append("svg:a").attr("xlink:href",(function(e){return e.url})).on("click",(function(e){var t=d3.event;t.defaultPrevented||t.ctrlKey||t.altKey||t.metaKey||t.shiftKey||0==t.button&&(t.preventDefault(),i.send(e.url))})),v=l.append("rect").attr("height",(function(e){return e.height()})),m=l.append("foreignObject").attr("class","js-animation-wrapper").attr("height",(function(e){return e.height()+2*e.animationRadius()})).attr("x",(function(e){return-e.animationRadius()})).attr("y",(function(e){return-e.animationRadius()})),_=m.append("xhtml:div").style("padding",(function(e){return e.animationRadius()+"px"}));_.style("height",(function(e){return e.height()+"px"}));var x=_.append("xhtml:div");x.attr("class","animation"),x.style("height",(function(e){return e.height()+"px"}));l.filter((function(e){return e.pinned()})).append("image").attr("xlink:href","/public/images/pin-ic-white.svg").attr("width",6).attr("y",(function(e){return e.height()/2-4.875})).attr("x",(function(e){return e.padding()}));l.filter((function(e){return e.has_icon()})).append("use").attr("xlink:href",(function(e){return"#"+e.id+"-svg-icon"})).attr("width",12).attr("height",12).attr("fill","white").attr("y",(function(e){return e.height()/2-6})).attr("x",(function(e){return e.padding()+(e.pinned()?6+e.padding():0)})),l.append("text").text((function(e){return e.name})).attr("dominant-baseline","middle").attr("text-anchor",(function(e){return e.pinned()||e.has_icon()?"end":"middle"})).attr("x",(function(e){return e.pinned()||e.has_icon()?e.width()-e.padding():e.width()/2})).attr("y",(function(e){return e.height()/2})),v.attr("width",(function(e){return e.width()})),m.attr("width",(function(e){return e.width()+2*e.animationRadius()})),x.style("width",(function(e){return e.width()+"px"})),_.style("width",(function(e){return e.width()+"px"})),o.layout();var E=[],b=o.nodes();for(var w in b)if("failed"==b[w].status){var S=b[w].position().x+b[w].width()/2,j=!1;for(var w in E)if(Math.abs(S-E[w])<2){j=!0;break}j||E.push(S)}e.selectAll("g.fail-triangle-node").remove();for(var w in E){var R=e.append("g").attr("class","fail-triangle-node"),T=(R.append("path").attr("class","fail-triangle-outline").attr("d","M191.62,136.3778H179.7521a5,5,0,0,1-4.3309-7.4986l5.9337-10.2851a5,5,0,0,1,8.6619,0l5.9337,10.2851A5,5,0,0,1,191.62,136.3778Z").attr("transform","translate(-174.7446 -116.0927)"),R.append("path").attr("class","fail-triangle").attr("d","M191.4538,133.0821H179.9179a2,2,0,0,1-1.7324-2.9994l5.7679-9.9978a2,2,0,0,1,3.4647,0l5.7679,9.9978A2,2,0,0,1,191.4538,133.0821Z").attr("transform","translate(-174.7446 -116.0927)"),R.node().getBBox()),M=24/T.height,q=T.width*M,C=E[w]-q/2;R.attr("transform","translate("+C+", "+"-44) scale("+M+")")}l.attr("class",(function(e){var t=[];return e.debugMarked&&t.push("marked"),e.columnMarked&&t.push("column-marked"),t.join(" ")})),f.attr("transform",(function(e){var t=e.position();return"translate("+t.x+", "+t.y+")"})),u.append("path").attr("d",(function(e){return e.path()})).on("mouseover",c).on("mouseout",h),o.nodes();var B,I,D,F,P,U=!0,L=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=g(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(o.nodes());try{for(L.s();!(P=L.n()).done;){var W=P.value,z=W.position(),H=z.x,Z=z.y,G=H+W.width(),$=Z+W.height();U?(B=H,I=Z,D=G,F=$,U=!1):(H<B&&(B=H),Z<I&&(I=Z),G>D&&(D=G),$>F&&(F=$))}}catch(e){L.e(e)}finally{L.f()}var J=D-B,Q=F-I;d3.select(e.node().parentNode).attr("viewBox",B-20+" "+(I-20)+" "+(J+40)+" "+(Q+40));var V=p(document.querySelectorAll(".job")),X=V.map((function(e){return e.cloneNode(!0)}));X.forEach((function(e){var t=e.querySelector("foreignObject");null!=t&&k(t),e.classList.remove("job"),e.classList.add("job-animation-node"),e.querySelectorAll("a").forEach(k),null!=t&&k(t),e.appendChild(t),e.querySelectorAll("text").forEach(k)})),V.forEach((function(e){return e.querySelectorAll(".js-animation-wrapper").forEach(k)}));var Y=document.querySelector("svg > g");null!=Y&&Y.prepend.apply(Y,p(X));var ee=Math.max(J,Q);document.querySelectorAll(".animation").forEach((function(e){ee<500?e.classList.add("animation-small"):ee<1500?e.classList.add("animation-medium"):ee<3e3?e.classList.add("animation-large"):e.classList.add("animation-xlarge")})),y&&(d.each((function(e){e.key==y&&c(e)})),a.each((function(e){e.key==y&&c(e)})))}}(e,t,n,i)()}(i,e,t,n)}function k(e){null!=e&&null!=e.parentNode&&e.parentNode.removeChild(e)}var x,E=function(){return x=x||d3.behavior.zoom()},b=!1;function w(){var e=d3.select("g.test");return e.empty()?b=!0:(e.attr("transform",""),E().translate([0,0]).scale(1).center(0,0)),e}function O(e,t){m.then((function(n){var r=t+"-svg-icon";if(null===document.getElementById(r)){var i=n.svg(e,r),o=document.createElement("template");o.innerHTML=i;var s=o.content.firstChild,a=document.getElementById("icon-store");null==a&&(a=function(){var e=document.createElement("div");return e.id="icon-store",e.style.display="none",document.body.appendChild(e),e}()),a.appendChild(s)}}))}function A(e){return"job-"+e}function K(e,t){return"job-"+e+"-output-"+t}function N(e,t){return"job-"+e+"-input-"+t}}}]);